import Chart from 'chart.js/auto';
import 'chartjs-adapter-moment';
import { load } from 'ol/Image';

// const precipitationData = {
//     "1577836800000000000": 9.067515094329792e-8,
//     "1577840400000000000": 5.183701645705696e-8,
//     "1577844000000000000": 0,
//     "1577847600000000000": 2.591850822852848e-8,
//     "1577851200000000000": 1.295925411426424e-8,
//     "1577854800000000000": 0,
//     "1577858400000000000": 0,
//     "1577862000000000000": 3.367028398315597e-7,
//     "1577865600000000000": 5.183701645705696e-8,
//     "1577869200000000000": 7.775553001465596e-8,
//     "1577872800000000000": 0,
//     "1577876400000000000": 0,
//     "1577880000000000000": 0,
//     "1577883600000000000": 0,
//     "1577887200000000000": 0,
//     "1577890800000000000": 0,
//     "1577894400000000000": 0,
//     "1577898000000000000": 0,
//     "1577901600000000000": 0,
//     "1577905200000000000": 0,
//     "1577908800000000000": 0,
//     "1577912400000000000": 0,
//     "1577916000000000000": 0,
//     "1577919600000000000": 7.775553001465596e-8,
//     "1577923200000000000": 1.2990959419312276e-7,
//     "1577926800000000000": 1.7453380962706433e-7,
//     "1577930400000000000": 5.311312634148635e-7,
//     "1577934000000000000": 5.310520236889715e-7,
//     "1577937600000000000": 5.08779521624092e-7,
//     "1577941200000000000": 6.870386641821824e-7,
//     "1577944800000000000": 6.648454018431948e-7,
//     "1577948400000000000": 0.0000017122861208918039,
//     "1577952000000000000": 1.9672702933348774e-7,
//     "1577955600000000000": 3.083272304138518e-7,
//     "1577959200000000000": 6.309215194733042e-8,
//     "1577962800000000000": 1.854719045013553e-8,
//     "1577966400000000000": 1.854719045013553e-8,
//     "1577970000000000000": 8.536463269592787e-8,
//     "1577973600000000000": 4.865070764026314e-7,
//     "1577977200000000000": 0.000001667582637310261,
//     "1577980800000000000": 0.0000025809920316532953,
//     "1577984400000000000": 0.0000016898551393751404,
//     "1577988000000000000": 0.0000013778818583887187,
//     "1577991600000000000": 0.000018267634004587308,
//     "1577995200000000000": 0.00000333865273205447,
//     "1577998800000000000": 5.757555072705145e-7,
//     "1578002400000000000": 7.762870950500655e-7,
//     "1578006000000000000": 0.0000015560616475340794
// };

function loadPrecipitationData(precipitationData) {

    // Convert the data into an array of {x, y} objects for Chart.js
    const dataPoints = Object.entries(precipitationData).map(([time, value]) => ({
        x: new Date(parseInt(time) / 1000000),  // Convert nanoseconds to milliseconds
        y: value * 1000  // Convert m to mm
    }));


    // Set up the Chart.js chart
    const ctx = document.getElementById('precipitationChart').getContext('2d');
    const chart = new Chart(ctx, {
        type: 'line',
        data: {
            datasets: [{
                label: 'Mean Precipitation',
                data: dataPoints,
                borderColor: 'blue',
                fill: false,
                tension: 0.1  // Line smoothness
            }]
        },
        options: {
            scales: {
                x: {
                    type: 'time',
                    time: {
                        // Custom display format for day and hour
                        displayFormats: {
                            hour: 'MMM DD, HH:00'  // Shows date (abbreviated month, day) and hour (AM/PM)
                        },
                        tooltipFormat: 'YYYY-MM-DD, HH:00', // Tooltip format for precision
                    },
                    title: {
                        display: true,
                        text: 'Time (UTC)'
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: 'Precipitation (mm)'
                    },
                    beginAtZero: true
                }
            }
        }
    })

}

